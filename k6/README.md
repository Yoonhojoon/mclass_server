# k6 ë¡œë“œ í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

ì´ ë””ë ‰í† ë¦¬ì—ëŠ” `users.csv` íŒŒì¼ì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•œ k6 ë¡œë“œ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ë“¤ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
k6/
â”œâ”€â”€ load-test-with-users.js      # ê¸°ë³¸ ë¡œë“œ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ advanced-load-test.js        # ê³ ê¸‰ ë¡œë“œ í…ŒìŠ¤íŠ¸ (ìˆ˜ê°• ì‹ ì²­ í¬í•¨)
â”œâ”€â”€ enrollment-only-test.js      # ìˆ˜ê°• ì‹ ì²­ ì „ìš© í…ŒìŠ¤íŠ¸
â”œâ”€â”€ concurrent-enrollment-test.js # ê¸°ì¡´ ë™ì‹œ ì‹ ì²­ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ run-enrollment-test.bat     # ìˆ˜ê°• ì‹ ì²­ ì „ìš© ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ run-load-test.bat           # Windows ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ run-test.bat                # ê¸°ì¡´ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ run-test.sh                 # Linux/Mac ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ README.md                   # ì´ íŒŒì¼
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### Windowsì—ì„œ ì‹¤í–‰

```bash
# ê¸°ë³¸ ë¡œë“œ í…ŒìŠ¤íŠ¸
k6/run-load-test.bat

# ê³ ê¸‰ ë¡œë“œ í…ŒìŠ¤íŠ¸
k6/run-load-test.bat advanced

# ìˆ˜ê°• ì‹ ì²­ ì „ìš© í…ŒìŠ¤íŠ¸
k6/run-enrollment-test.bat

# ë‹¤ë¥¸ URLë¡œ í…ŒìŠ¤íŠ¸
k6/run-load-test.bat basic http://your-server:3000
k6/run-enrollment-test.bat http://your-server:3000
```

### ì§ì ‘ ì‹¤í–‰

```bash
# ê¸°ë³¸ í…ŒìŠ¤íŠ¸
k6 run --env BASE_URL=http://localhost:3000 k6/load-test-with-users.js

# ê³ ê¸‰ í…ŒìŠ¤íŠ¸
k6 run --env BASE_URL=http://localhost:3000 k6/advanced-load-test.js

# ìˆ˜ê°• ì‹ ì²­ ì „ìš© í…ŒìŠ¤íŠ¸
k6 run --env BASE_URL=http://localhost:3000 k6/enrollment-only-test.js
```

## ğŸ“Š í…ŒìŠ¤íŠ¸ ì¢…ë¥˜

### 1. ê¸°ë³¸ ë¡œë“œ í…ŒìŠ¤íŠ¸ (`load-test-with-users.js`)

**íŠ¹ì§•:**
- 200ëª…ì˜ ì‚¬ìš©ì ë°ì´í„° ì‚¬ìš©
- ì½ê¸° ì „ìš© API í…ŒìŠ¤íŠ¸
- ë¶€í•˜ ë‹¨ê³„: 5 â†’ 20 â†’ 20 â†’ 0 (ì´ 2ë¶„)

**í…ŒìŠ¤íŠ¸ API:**
- ì‚¬ìš©ì í”„ë¡œí•„ ì¡°íšŒ
- MClass ëª©ë¡ ì¡°íšŒ
- ìˆ˜ê°• ì‹ ì²­ì„œ ëª©ë¡ ì¡°íšŒ
- ìˆ˜ê°• ì‹ ì²­ ëª©ë¡ ì¡°íšŒ
- í† í° ê°±ì‹  (10% í™•ë¥ )

### 2. ê³ ê¸‰ ë¡œë“œ í…ŒìŠ¤íŠ¸ (`advanced-load-test.js`)

**íŠ¹ì§•:**
- ìˆ˜ê°• ì‹ ì²­ ì‹œë‚˜ë¦¬ì˜¤ í¬í•¨
- ì‹¤ì œ ì‚¬ìš©ì í”Œë¡œìš° ì‹œë®¬ë ˆì´ì…˜
- ë¶€í•˜ ë‹¨ê³„: 10 â†’ 30 â†’ 30 â†’ 0 (ì´ 3ë¶„)

**í…ŒìŠ¤íŠ¸ API:**
- MClass ëª©ë¡ ì¡°íšŒ
- ìˆ˜ê°• ì‹ ì²­ì„œ ì¡°íšŒ
- ìˆ˜ê°• ì‹ ì²­ (30% í™•ë¥ )
- ë‚´ ì‹ ì²­ ëª©ë¡ ì¡°íšŒ
- ì‚¬ìš©ì í”„ë¡œí•„ ì¡°íšŒ

### 3. ìˆ˜ê°• ì‹ ì²­ ì „ìš© í…ŒìŠ¤íŠ¸ (`enrollment-only-test.js`)

**íŠ¹ì§•:**
- íŠ¹ì • MClassì— ëŒ€í•œ ìˆ˜ê°• ì‹ ì²­ë§Œ í…ŒìŠ¤íŠ¸
- ê³ ì •ëœ MClass ID ì‚¬ìš©: `6390cd1c-6514-4a19-9224-0d89c17a54d3`
- ë¶€í•˜ ë‹¨ê³„: 5 â†’ 15 â†’ 15 â†’ 0 (ì´ 2ë¶„)

**í…ŒìŠ¤íŠ¸ API:**
- MClass ìƒì„¸ ì •ë³´ ì¡°íšŒ
- ìˆ˜ê°• ì‹ ì²­ì„œ ì¡°íšŒ
- ìˆ˜ê°• ì‹ ì²­ (100% í™•ë¥ )
- ë‚´ ì‹ ì²­ ëª©ë¡ ì¡°íšŒ (í™•ì¸ìš©)

## ğŸ“ˆ ì„±ëŠ¥ ê¸°ì¤€

### ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ê¸°ì¤€
- **ì‘ë‹µ ì‹œê°„**: 95% ìš”ì²­ì´ 1ì´ˆ ì´ë‚´
- **ì—ëŸ¬ìœ¨**: 5% ë¯¸ë§Œ
- **ê°œë³„ API ê¸°ì¤€**:
  - ì¸ì¦: 500ms ì´ë‚´
  - í”„ë¡œí•„: 300ms ì´ë‚´
  - ì‹ ì²­: 800ms ì´ë‚´
  - MClass: 200ms ì´ë‚´

### ê³ ê¸‰ í…ŒìŠ¤íŠ¸ ê¸°ì¤€
- **ì‘ë‹µ ì‹œê°„**: 95% ìš”ì²­ì´ 1.5ì´ˆ ì´ë‚´
- **ì—ëŸ¬ìœ¨**: 3% ë¯¸ë§Œ
- **ìˆ˜ê°• ì‹ ì²­ ì„±ê³µìœ¨**: 95% ì´ìƒ
- **ê°œë³„ API ê¸°ì¤€**:
  - MClass: 300ms ì´ë‚´
  - ì‹ ì²­: 1000ms ì´ë‚´
  - ì‹ ì²­ì„œ: 400ms ì´ë‚´

### ìˆ˜ê°• ì‹ ì²­ ì „ìš© í…ŒìŠ¤íŠ¸ ê¸°ì¤€
- **ì‘ë‹µ ì‹œê°„**: 95% ìš”ì²­ì´ 2ì´ˆ ì´ë‚´
- **ì—ëŸ¬ìœ¨**: 5% ë¯¸ë§Œ
- **ìˆ˜ê°• ì‹ ì²­ ì„±ê³µìœ¨**: 90% ì´ìƒ
- **ê°œë³„ API ê¸°ì¤€**:
  - MClass: 300ms ì´ë‚´
  - ì‹ ì²­: 1500ms ì´ë‚´
  - ì‹ ì²­ì„œ: 500ms ì´ë‚´

## ğŸ”§ ì„¤ì • ì˜µì…˜

### í™˜ê²½ ë³€ìˆ˜

```bash
# ê¸°ë³¸ URL ì„¤ì •
BASE_URL=http://localhost:3000

# ë‹¤ë¥¸ ì„œë²„ë¡œ í…ŒìŠ¤íŠ¸
BASE_URL=https://your-production-server.com
```

### í…ŒìŠ¤íŠ¸ ë‹¨ê³„ ì¡°ì •

ê° í…ŒìŠ¤íŠ¸ íŒŒì¼ì˜ `options.stages`ë¥¼ ìˆ˜ì •í•˜ì—¬ ë¶€í•˜ íŒ¨í„´ì„ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```javascript
export const options = {
  stages: [
    { duration: '10s', target: 5 },    // ì›Œë°ì—…
    { duration: '30s', target: 20 },   // ë¶€í•˜ ì¦ê°€
    { duration: '60s', target: 20 },   // ì§€ì† ë¶€í•˜
    { duration: '20s', target: 0 },    // ì ì§„ì  ê°ì†Œ
  ],
  // ...
};
```

## ğŸ“‹ ì‚¬ìš©ì ë°ì´í„°

í…ŒìŠ¤íŠ¸ëŠ” `artillery/artillery/users.csv` íŒŒì¼ì˜ 200ëª… ì‚¬ìš©ì ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:

```csv
email,password,accessToken
user1@test.com,password123,eyJhbGciOiJIUzI1NiIs...
user2@test.com,password123,eyJhbGciOiJIUzI1NiIs...
...
```

## ğŸ“Š ê²°ê³¼ í•´ì„

### ì„±ê³µì ì¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼

```
âœ“ http_req_duration..............: avg=245.12ms min=45.12ms med=180.23ms max=890.45ms p(95)=456.78ms
âœ“ http_req_failed...............: 0.00% âœ“ 0.00% âœ— 0.00%
âœ“ enrollment_success............: 100.00% âœ“ 15 âœ— 0
```

### ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸ ê²°ê³¼

```
âœ— http_req_duration..............: avg=1200.45ms min=200.12ms med=890.23ms max=3000.45ms p(95)=2500.78ms
âœ— http_req_failed...............: 15.00% âœ“ 85 âœ— 15
```

## ğŸ› ï¸ ë¬¸ì œ í•´ê²°

### k6 ì„¤ì¹˜

```bash
# Windows (Chocolatey)
choco install k6

# Windows (Scoop)
scoop install k6

# macOS
brew install k6

# Linux
sudo gpg -k
sudo gpg --no-default-keyring --keyring /usr/share/keyrings/k6-archive-keyring.gpg --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys C5AD17C747E3415A3642D57D77C6C491D6AC1D69
echo "deb [signed-by=/usr/share/keyrings/k6-archive-keyring.gpg] https://dl.k6.io/deb stable main" | sudo tee /etc/apt/sources.list.d/k6.list
sudo apt-get update
sudo apt-get install k6
```

### ì¼ë°˜ì ì¸ ë¬¸ì œ

1. **CSV íŒŒì¼ ê²½ë¡œ ì˜¤ë¥˜**
   - `artillery/artillery/users.csv` íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
   - ìƒëŒ€ ê²½ë¡œê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸

2. **ì„œë²„ ì—°ê²° ì‹¤íŒ¨**
   - ëŒ€ìƒ ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
   - URLê³¼ í¬íŠ¸ê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸

3. **í† í° ë§Œë£Œ**
   - `users.csv`ì˜ í† í°ì´ ìœ íš¨í•œì§€ í™•ì¸
   - í•„ìš”ì‹œ ìƒˆë¡œìš´ í† í°ìœ¼ë¡œ ì—…ë°ì´íŠ¸

## ğŸ“ ë¡œê·¸ ë¶„ì„

í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘ ë‹¤ìŒê³¼ ê°™ì€ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```
âœ… ìˆ˜ê°• ì‹ ì²­ ì„±ê³µ: user1@test.com -> class-id-123
â„¹ï¸ ì´ë¯¸ ì‹ ì²­ëœ í´ë˜ìŠ¤: user2@test.com -> class-id-123
âŒ í”„ë¡œí•„ ì¡°íšŒ ì‹¤íŒ¨: 401 - user3@test.com
```

## ğŸ”„ ì§€ì†ì ì¸ ëª¨ë‹ˆí„°ë§

í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ì •ê¸°ì ìœ¼ë¡œ ë¡œë“œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤:

```bash
# ë§¤ì¼ ë°¤ 2ì‹œì— í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (cron ì˜ˆì‹œ)
0 2 * * * cd /path/to/project && k6 run --env BASE_URL=https://your-server.com k6/load-test-with-users.js
```
